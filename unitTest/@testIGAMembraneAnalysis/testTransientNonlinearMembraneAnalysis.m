function testTransientNonlinearMembraneAnalysis(testCase)
%% Licensing
%
% License:         BSD License
%                  cane Multiphysics default license: cane/license.txt
%
% Main authors:    Andreas Apostolatos
%
%% Function documentation
%
% Test the transient nonlinear isogeometric membrane analysis using the
% explicit Euler time integration scheme over a semisphere subject to its 
% weight, constant internal pressure and a dirac point load which is 
% released after the dynamic analysis starts.
% 
% Function layout :
%
% 0. Read input
%
% 1. Define the multipatch geometry in terms of NURBS
%
% 2. Define the material parameters
%
% 3. GUI
%
% 4. Define the refinement
%
% 5. Get the parametric location of the point load application
%
% 6. Dirichlet and Neumann boundary conditions
%
% 7. Create the patch cell array
%
% 8. Define the expected solutions
%
% 9. Define the nonlinear analysis parameters
%
% 10. Define transient analysis properties
%
% 11. Solve the transient nonlinear problem
%
% 12. Verify the solution
%
%% Function main body

%% 0. Read input

% Define absolute tolerance
absTol = 1e-14;

%% 1. Define the multipatch geometry in terms of NURBS

% Polynomial degrees
p = 2;
q = 2;

% Knot vectors
Xi = [                 0
                       0
                       0
       0.166666666666667
       0.333333333333333
       0.500000000000000
       0.666666666666667
       0.833333333333333
       1.000000000000000
       1.000000000000000
       1.000000000000000]';
Eta = [                    0
                           0
                           0
           0.166666666666667
           0.333333333333333
           0.500000000000000
           0.666666666666667
           0.833333333333333
           1.000000000000000
           1.000000000000000
           1.000000000000000]';

% Control Point coordinates

% x-coordinates
CP(:,:,1) = [ -0.053033008588991  -0.046462253662236  -0.029925055443628  -0.010355339059327   0.010355339059327   0.029925055443628   0.046462253662236   0.053033008588991
              -0.059603763515746  -0.053789986622097  -0.036276226691635  -0.012844490465199   0.012844490465199   0.036276226691635   0.053789986622097   0.059603763515746
              -0.069490949413548  -0.066682578181259  -0.051389330312926  -0.020247145899842   0.020247145899842   0.051389330312926   0.066682578181259   0.069490949413548
              -0.075000000000000  -0.074503727235714  -0.064231111694526  -0.028100604679647   0.028100604679647   0.064231111694526   0.074503727235714   0.075000000000000
              -0.075000000000000  -0.074503727235714  -0.064231111694526  -0.028100604679647   0.028100604679647   0.064231111694526   0.074503727235714   0.075000000000000
              -0.069490949413548  -0.066682578181259  -0.051389330312926  -0.020247145899842   0.020247145899842   0.051389330312926   0.066682578181259   0.069490949413548
              -0.059603763515746  -0.053789986622097  -0.036276226691635  -0.012844490465199   0.012844490465199   0.036276226691635   0.053789986622097   0.059603763515746
              -0.053033008588991  -0.046462253662236  -0.029925055443628  -0.010355339059327   0.010355339059327   0.029925055443628   0.046462253662236   0.053033008588991];
         
% y-coordinates
CP(:,:,2) = [ -0.053033008588991  -0.059603763515746  -0.069490949413548  -0.075000000000000  -0.075000000000000  -0.069490949413548  -0.059603763515746  -0.053033008588991
              -0.046462253662236  -0.053789986622097  -0.066682578181258  -0.074503727235714  -0.074503727235714  -0.066682578181259  -0.053789986622097  -0.046462253662236
              -0.029925055443628  -0.036276226691635  -0.051389330312926  -0.064231111694526  -0.064231111694526  -0.051389330312926  -0.036276226691635  -0.029925055443628
              -0.010355339059327  -0.012844490465199  -0.020247145899842  -0.028100604679647  -0.028100604679647  -0.020247145899842  -0.012844490465199  -0.010355339059327
               0.010355339059327   0.012844490465199   0.020247145899842   0.028100604679647   0.028100604679647   0.020247145899842   0.012844490465199   0.010355339059327
               0.029925055443628   0.036276226691635   0.051389330312926   0.064231111694526   0.064231111694526   0.051389330312926   0.036276226691635   0.029925055443628
               0.046462253662236   0.053789986622097   0.066682578181259   0.074503727235714   0.074503727235714   0.066682578181259   0.053789986622097   0.046462253662236
               0.053033008588991   0.059603763515746   0.069490949413548   0.075000000000000   0.075000000000000   0.069490949413548   0.059603763515746   0.053033008588991];
         
% z-coordinates
CP(:,:,3) = [  0                   0                   0                   0                   0                   0                   0                   0
               0   0.002387453409876   0.006672660956309   0.009117179053618   0.009117179053618   0.006672660956309   0.002387453409876                   0
               0   0.006672660956309   0.023450643108123   0.037341851315138   0.037341851315138   0.023450643108123   0.006672660956309                   0
               0   0.009117179053618   0.037341851315138   0.067672292986537   0.067672292986537   0.037341851315138   0.009117179053618                   0
               0   0.009117179053618   0.037341851315138   0.067672292986537   0.067672292986537   0.037341851315138   0.009117179053618                   0
               0   0.006672660956309   0.023450643108123   0.037341851315138   0.037341851315138   0.023450643108123   0.006672660956309                   0
               0   0.002387453409876   0.006672660956309   0.009117179053618   0.009117179053618   0.006672660956309   0.002387453409876                   0
               0                   0                   0                   0                   0                   0                   0                   0];
       
% Weights
CP(:,:,4) = [  1.000000000000000   0.951184463531091   0.886097081572546   0.853553390593274   0.853553390593274   0.886097081572546   0.951184463531091   1.000000000000000
               0.951184463531091   0.904751883662930   0.842841777172048   0.811886723926607   0.811886723926607   0.842841777172048   0.904751883662930   0.951184463531091
               0.886097081572546   0.842841777172048   0.785168037971384   0.756331168371052   0.756331168371052   0.785168037971384   0.842841777172048   0.886097081572546
               0.853553390593274   0.811886723926607   0.756331168371052   0.728553390593274   0.728553390593274   0.756331168371052   0.811886723926607   0.853553390593274
               0.853553390593274   0.811886723926607   0.756331168371052   0.728553390593274   0.728553390593274   0.756331168371052   0.811886723926607   0.853553390593274
               0.886097081572546   0.842841777172048   0.785168037971384   0.756331168371052   0.756331168371052   0.785168037971384   0.842841777172048   0.886097081572546
               0.951184463531091   0.904751883662930   0.842841777172048   0.811886723926607   0.811886723926607   0.842841777172048   0.904751883662930   0.951184463531091
               1.000000000000000   0.951184463531091   0.886097081572546   0.853553390593274   0.853553390593274   0.886097081572546   0.951184463531091   1.000000000000000];

% Find whether the geometrical basis is a NURBS or a B-Spline
isNURBS = 0;
nxi = length(CP(:,1,1));
neta = length(CP(1,:,1));
for i = 1:nxi
    for j = 1:neta
        if CP(i,j,4) ~= 1
            isNURBS = 1;
            break;
        end
    end
    if isNURBS
        break;
    end
end

%% 2. Define the material parameters

% Young's modulus
parameters.E = 7.e5;

% Poisson ratio
parameters.nue = 0.49;

% Thickness of the shell
parameters.t = 1.65e-4;

% Density of the shell (used only for dynamics)
parameters.rho = 1050;

% Prestress for the membrane
parameters.prestress.computeParametricCoordinates = @(X) [X(1,1)^2 + X(2,1)^2
                                                          atan(X(2,1)/X(1,1))];
parameters.prestress.computeBaseVectors = @(theta1,theta2) [ cos(theta2) -sin(theta2)
                                                             sin(theta2) cos(theta2)
                                                             0           0];
parameters.prestress.voigtVector = [7794.5
                                    7794.5
                                    0];

%% 3. GUI

% Analysis type
analysis.type = 'isogeometricMembraneAnalysis';

% Case name
caseName = 'transientSemisphere';

% Define linear equation system solver
solve_LinearSystem = @solve_LinearSystemMatlabBackslashSolver;

% Co-simulation with EMPIRE
propEmpireCoSimulation.isCoSimulation = false; % Flag on whether co-simulation with EMPIRE is assumed
propEmpireCoSimulation.isInterfaceLayer = false; % Flag on whether the matlab client is used as an interface layer
propEmpireCoSimulation.strMatlabXml = 'undefined'; % Name of the xml file for Matlab

% Integration scheme
% type = 'default' : default FGI integration element-wise
% type = 'manual' : manual choice of the number of Gauss points
int.type = 'default';
if strcmp(int.type,'user')
    int.xiNGP = 6;
    int.etaNGP = 6;
    int.xiNGPForLoad = 6;
    int.xetaNGPForLoad = 6;
end

% Function handle to writing out the results
propOutput = 'undefined';

% Postprocessing
propPostproc.resultant = {'displacement'};
propPostproc.computeResultant = {'computeDisplacement'};

%% 4. Define the refinement

% Degree by which to elevate
a = 0;
tp = a;
tq = a;
[Xi,Eta,CP,p,q] = degreeElevateBSplineSurface(p,q,Xi,Eta,CP,tp,tq,'');

% Number of knots to exist in both directions
scaling = 0;
refXi = scaling;
refEta = scaling;
[Xi,Eta,CP] = knotRefineUniformlyBSplineSurface(p,Xi,q,Eta,CP,refXi,refEta,'');

%% 5. Get the parametric location of the point load application
Radius = norm(squeeze(CP(end,1,1:3)));
xi0 = .5;
eta0 = .5;
P = Radius/sqrt(2)*[1; 1; 1];
propNewtonRaphson.eps = 1e-15;
propNewtonRaphson.maxIt = 1000;
[xiP,etaP,~,isProjected,~] = ...
    computeNearestPointProjectionOnBSplineSurface...
    (P,p,Xi,q,Eta,CP,isNURBS,xi0,eta0,propNewtonRaphson);
if ~isProjected
    error('The point of the load application could not be found on patch 2');
end

%% 6. Dirichlet and Neumann boundary conditions

% Homogeneous Dirichlet boundary conditions
homDOFs = [];
xiSup = [0 0];   etaSup = [0 1];
for dirSupp = 1:3
    homDOFs = findDofs3D(homDOFs,xiSup,etaSup,dirSupp,CP);
end
xiSup = [0 1];   etaSup = [0 0];
for dirSupp = 1:3
    homDOFs = findDofs3D(homDOFs,xiSup,etaSup,dirSupp,CP);
end
xiSup = [1 1];   etaSup = [0 1];
for dirSupp = 1:3
    homDOFs = findDofs3D(homDOFs,xiSup,etaSup,dirSupp,CP);
end
xiSup = [0 1];   etaSup = [1 1];
for dirSupp = 1:3
    homDOFs = findDofs3D(homDOFs,xiSup,etaSup,dirSupp,CP);
end

% Inhomogeneous Dirichlet boundary conditions
inhomDOFs = [];
valuesInhomDOFs = [];

% Weak Dirichlet boundary conditions
weakDBC.noCnd = 0;

% Embedded cables
cables.No = 0;

% Pressure Load amplitude
FAmpPressure = - 43.2;
FAmpWeight = - 9.81*parameters.rho*parameters.t;
scaling = 10;
FPointLoad = .018;
FAmpPoint = @(x,y,z,t)scaling*FPointLoad*(t<0.001);

% load (Neuman boundary conditions)
% FAmp = 0;
xib1 = [0 1];   etab1 = [0 1];   dirForcePressure = 'normal';
xib2 = [0 1];   etab2 = [0 1];   dirForceWeight = 'z';
xiP2 = xiP;    etaP2 = etaP; dirForcePoint = 'normal';
NBC.noCnd = 3;
NBC.xiLoadExtension = {xib1 xib2 xiP2};
NBC.etaLoadExtension = {etab1 etab2 etaP2};
NBC.loadAmplitude = {FAmpPressure FAmpWeight FAmpPoint};
NBC.loadDirection = {dirForcePressure dirForceWeight dirForcePoint};
NBC.computeLoadVct = {'computeLoadVctAreaIGAThinStructure' 'computeLoadVctAreaIGAThinStructure' 'computeLoadVctPointIGAThinStructure'};
NBC.isFollower = [true; false; false];
NBC.isTimeDependent = [false; false; false];

%% 7. Create the patch cell array
BSplinePatch = fillUpPatch...
    (analysis,p,Xi,q,Eta,CP,isNURBS,parameters,homDOFs,inhomDOFs,...
    valuesInhomDOFs,weakDBC,cables,NBC,[],[],[],[],[],int);
BSplinePatches = {BSplinePatch};

%% 8. Define the expected solutions

% Define the expected solution for the Penalty method in terms of the
% Control Point displacements
expSolDispHistory = [      0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0  -0.000052127266013  -0.000014876745462   0.000067762473037   0.000093527670380  -0.000004341114830  -0.000027465101937   0.000096057084998   0.000081195949635  -0.000030188945720   0.000012802681376   0.000103244256291
                           0  -0.000052127266013  -0.000014876745462   0.000067762473037   0.000093527670380  -0.000004341114830  -0.000027465101937   0.000096057084998   0.000081195949635  -0.000030188945720   0.000012802681376   0.000103244256291
                           0   0.000022055784430   0.000022000222552   0.000018566423924   0.000014926467533   0.000020535146661   0.000024850737765   0.000014966773619   0.000013540859749   0.000025175181702   0.000021912780572   0.000011047777254
                           0  -0.000109926737967  -0.000045887069716   0.000196387808652   0.000286248095384  -0.000031025824912  -0.000060156436834   0.000259463957880   0.000240871261387  -0.000070599232774  -0.000029341050640   0.000370377782023
                           0  -0.000071150942312  -0.000036024082820   0.000107352321890   0.000161877000917  -0.000027360927923  -0.000044856321384   0.000143375502706   0.000137927978824  -0.000053661750543  -0.000029833724914   0.000219819991032
                           0   0.000060268744869   0.000060020260213   0.000048874976885   0.000037390400446   0.000060634240477   0.000063054985569   0.000039236279297   0.000044359219903   0.000058957908199   0.000064716457680   0.000026598613008
                           0  -0.000140359698294  -0.000024754076085   0.000266438314545   0.000354955485678   0.000042409163592  -0.000094510211094   0.000330695165171   0.000412202439530  -0.000190262225191   0.000079899738681   0.000495220139996
                           0  -0.000079703718932  -0.000034698315005   0.000061264937950   0.000087587602815  -0.000004924033384  -0.000063845673668   0.000077007923102   0.000126275842910  -0.000101910228591  -0.000005959469188   0.000157949917687
                           0   0.000086324090419   0.000078922134080   0.000058649439330   0.000055840632035   0.000072720455856   0.000080041374258   0.000061272614855   0.000039978343345   0.000089239458357   0.000078372119936   0.000026873037670
                           0  -0.000018481022578   0.000032981517935   0.000202462668740   0.000346834792019   0.000077861392134  -0.000116504219615   0.000401230976267   0.000296195523692  -0.000177540771149   0.000270500234892   0.000233693789307
                           0  -0.000056408512314  -0.000043806824386  -0.000011944648402  -0.000002643724039  -0.000033167561717  -0.000053010746456  -0.000009067099700   0.000013499488234  -0.000062339412197  -0.000045777748356   0.000030291777056
                           0   0.000072372349139   0.000069730298147   0.000073362592629   0.000054621849279   0.000059027580006   0.000100691150733   0.000043080038941   0.000046077892098   0.000110691763734   0.000040331521150   0.000065759411477
                           0   0.000079849136284   0.000061965678277   0.000103237317673   0.000222758209568   0.000055827897662  -0.000044509741438   0.000276768193176   0.000102014286839  -0.000033508719295   0.000216507960909   0.000035887448641
                           0  -0.000054868036233  -0.000066803625883  -0.000037208405154  -0.000049497622331  -0.000073433187711  -0.000025990758984  -0.000081347772445  -0.000031048222364  -0.000030275634278  -0.000120175663698   0.000018520113828
                           0   0.000040754353682   0.000049592594230   0.000063860165488   0.000040500608490   0.000050186456048   0.000076162149398   0.000027008028344   0.000059097653062   0.000070837141305   0.000028990978474   0.000071076251111
                           0  -0.000013780399381   0.000020406473362   0.000053697916314   0.000040550974709   0.000029858886687   0.000016035690981   0.000058845017891   0.000026305548513   0.000019850505304   0.000064861332603  -0.000015158778035
                           0  -0.000030166514956  -0.000042244839717  -0.000036971673932  -0.000018355870700  -0.000049191189033  -0.000036898358031  -0.000033168933805  -0.000019141893154  -0.000037852420274  -0.000067929936316   0.000024526505839
                           0   0.000019983930266   0.000021367708018   0.000017994820352   0.000019297286119   0.000023463848773   0.000018443905490   0.000018597877060   0.000025146161421   0.000017945634262   0.000017645203105   0.000028786195278
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0  -0.000071150942312  -0.000036024082820   0.000107352321890   0.000161877000917  -0.000027360927923  -0.000044856321384   0.000143375502706   0.000137927978824  -0.000053661750543  -0.000029833724914   0.000219819991032
                           0  -0.000109926737967  -0.000045887069716   0.000196387808652   0.000286248095384  -0.000031025824912  -0.000060156436834   0.000259463957880   0.000240871261387  -0.000070599232774  -0.000029341050640   0.000370377782023
                           0   0.000060268744869   0.000060020260213   0.000048874976885   0.000037390400446   0.000060634240477   0.000063054985569   0.000039236279297   0.000044359219903   0.000058957908199   0.000064716457680   0.000026598613008
                           0  -0.000232265449006  -0.000118478643993   0.000228555073582   0.000418719725145  -0.000020810736055  -0.000287082522032   0.000392637648348   0.000481266900652  -0.000365097181000  -0.000013158696552   0.000585997191678
                           0  -0.000232265449006  -0.000118478643993   0.000228555073582   0.000418719725145  -0.000020810736055  -0.000287082522032   0.000392637648348   0.000481266900652  -0.000365097181000  -0.000013158696552   0.000585997191678
                           0   0.000227333982423   0.000233947704067   0.000226649023323   0.000183436727008   0.000208398499957   0.000290115153019   0.000192805354465   0.000131260084084   0.000305048402472   0.000242919053148   0.000113791856849
                           0  -0.000314003119516  -0.000221266101910   0.000232893777162   0.000559545228351  -0.000159599029855  -0.000447247650591   0.000591429721321   0.000403080317509  -0.000481394778737   0.000048486217985   0.000471116890134
                           0  -0.000214701525792  -0.000161021544897   0.000124366968539   0.000333186371216  -0.000112679249936  -0.000314021014171   0.000338496363602   0.000276200987488  -0.000357634963775  -0.000008643396888   0.000338968641643
                           0   0.000367951627716   0.000390339509886   0.000411196734339   0.000318076022176   0.000368445554608   0.000504251242647   0.000289930430402   0.000323302591994   0.000504170738989   0.000333973907103   0.000356160910342
                           0  -0.000372580156240  -0.000238170596598   0.000326401500550   0.000475368478319  -0.000316412075593  -0.000115610121677   0.000510037928690   0.000032654229517  -0.000055880190913   0.000036743110482   0.000121977520616
                           0  -0.000208775264707  -0.000151752733783   0.000022585218151   0.000127658461824  -0.000091900988284  -0.000261806488074   0.000114928417904   0.000188636460539  -0.000342098336368  -0.000066175029416   0.000238503264360
                           0   0.000381347158454   0.000418392004208   0.000363409188291   0.000312619594213   0.000478449514276   0.000374951001993   0.000289344092245   0.000503232930691   0.000311512487060   0.000368661851619   0.000496987546101
                           0  -0.000249401333401  -0.000100764650622   0.000333235807903   0.000252200007878  -0.000197189260504   0.000216623370866   0.000234138020592  -0.000070126090885   0.000303543016837  -0.000012359799148  -0.000007872563493
                           0  -0.000262401763093  -0.000161260701196  -0.000116126689811  -0.000029962936393  -0.000017086867752  -0.000413775895795   0.000004492183063   0.000211974457441  -0.000574796066967  -0.000018279431991   0.000176563440338
                           0   0.000256659891586   0.000254954320431   0.000173835974802   0.000204392139157   0.000308478420443   0.000133882397796   0.000219070125223   0.000324583644071   0.000084966835626   0.000267501615941   0.000295392423994
                           0   0.000028104019986   0.000025328642238   0.000092018176910   0.000069820669765  -0.000023611519468   0.000128594917373   0.000034979686288  -0.000015057763503   0.000194197665157  -0.000052053368669   0.000074242594623
                           0  -0.000219380281899  -0.000161686582661  -0.000077270100173  -0.000044668737051  -0.000081753519336  -0.000271989585611  -0.000000106487071   0.000056677291682  -0.000422538340830   0.000041629477038  -0.000058645323627
                           0   0.000071264744937   0.000054932467042   0.000047293191353   0.000058698411941   0.000060937727805   0.000032396748889   0.000061212464903   0.000072869455676   0.000004450030175   0.000077367871323   0.000052148475635
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0  -0.000079703718932  -0.000034698315005   0.000061264937950   0.000087587602815  -0.000004924033384  -0.000063845673668   0.000077007923102   0.000126275842910  -0.000101910228591  -0.000005959469188   0.000157949917687
                           0  -0.000140359698294  -0.000024754076085   0.000266438314545   0.000354955485678   0.000042409163592  -0.000094510211094   0.000330695165171   0.000412202439530  -0.000190262225191   0.000079899738681   0.000495220139996
                           0   0.000086324090419   0.000078922134080   0.000058649439330   0.000055840632035   0.000072720455856   0.000080041374258   0.000061272614855   0.000039978343345   0.000089239458357   0.000078372119936   0.000026873037670
                           0  -0.000214701525792  -0.000161021544897   0.000124366968539   0.000333186371216  -0.000112679249936  -0.000314021014171   0.000338496363602   0.000276200987488  -0.000357634963775  -0.000008643396888   0.000338968641643
                           0  -0.000314003119516  -0.000221266101910   0.000232893777162   0.000559545228351  -0.000159599029855  -0.000447247650591   0.000591429721321   0.000403080317510  -0.000481394778737   0.000048486217985   0.000471116890134
                           0   0.000367951627716   0.000390339509886   0.000411196734339   0.000318076022176   0.000368445554608   0.000504251242647   0.000289930430402   0.000323302591994   0.000504170738989   0.000333973907103   0.000356160910342
                           0  -0.000730230765069  -0.000475130481075   0.000255660811087   0.000419760485562  -0.000448620084031  -0.000429101898631   0.000411727909691   0.000179663027001  -0.000462940428545  -0.000228976461309   0.000375899637492
                           0  -0.000730230765069  -0.000475130481075   0.000255660811087   0.000419760485562  -0.000448620084031  -0.000429101898631   0.000411727909691   0.000179663027001  -0.000462940428545  -0.000228976461309   0.000375899637492
                           0   0.000984272982472   0.001009298621494   0.000901927599842   0.000846086265168   0.001058984059147   0.000957151802034   0.000854593519170   0.000993943697175   0.000923192412711   0.001002149942292   0.000891893819157
                           0  -0.001028556821341  -0.000550321004252   0.000427294477035   0.000267854237471  -0.000528060778699  -0.000146007206511   0.000238626258472   0.000058106813836  -0.000237703517401  -0.000267907761887   0.000235044745824
                           0  -0.000350642463792  -0.000256122007286   0.000221315549920   0.000479337884336  -0.000229239537669  -0.000375161003245   0.000494455331710   0.000285311840749  -0.000411414899475  -0.000000140125346   0.000373561133928
                           0   0.001470607613932   0.001104630153778   0.000693908376738   0.001047521455520   0.001075678144312   0.000716816836184   0.001067308354510   0.001000172545531   0.000813025241243   0.001039932898578   0.000925829643712
                           0  -0.000738969997830  -0.000297364447845   0.000422682316618   0.000083830064521  -0.000266711100004   0.000182670076971   0.000045923342879   0.000033475382230   0.000111120571304  -0.000180174883267   0.000141934557379
                           0   0.000341385757748  -0.000144419303618  -0.000263921565105   0.000477400880282  -0.000243736596607  -0.000730737864105   0.000530576168640   0.000080427513851  -0.000684221383226   0.000141101917278   0.000070888004539
                           0   0.000848813189044   0.000491643111591   0.000197814736003   0.000529493177536   0.000424781254482   0.000187825946002   0.000513435499014   0.000439244124915   0.000216496360635   0.000486021578463   0.000421501049101
                           0  -0.000315913966900  -0.000087446565795   0.000186629894814  -0.000046961047464  -0.000039111326483   0.000147552669162  -0.000079234171403   0.000079831752614   0.000060456486103  -0.000074177854676   0.000119255801081
                           0  -0.000069179742384  -0.000168346247245  -0.000292225187431   0.000191220033882  -0.000164256240886  -0.000735936677584   0.000421375527534  -0.000219039511950  -0.000574692677583   0.000261804712189  -0.000517938363700
                           0   0.000019056861993   0.000066066323121   0.000061185641813   0.000078127051037   0.000089896602105  -0.000014831967734   0.000113041043606   0.000064104265337   0.000004594812905   0.000134165134093  -0.000007278223525
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0  -0.000056408512314  -0.000043806824386  -0.000011944648402  -0.000002643724039  -0.000033167561717  -0.000053010746456  -0.000009067099700   0.000013499488234  -0.000062339412197  -0.000045777748356   0.000030291777056
                           0  -0.000018481022578   0.000032981517935   0.000202462668740   0.000346834792019   0.000077861392134  -0.000116504219615   0.000401230976267   0.000296195523692  -0.000177540771149   0.000270500234892   0.000233693789307
                           0   0.000072372349139   0.000069730298147   0.000073362592629   0.000054621849279   0.000059027580006   0.000100691150733   0.000043080038941   0.000046077892098   0.000110691763734   0.000040331521150   0.000065759411477
                           0  -0.000208775264707  -0.000151752733783   0.000022585218151   0.000127658461824  -0.000091900988284  -0.000261806488074   0.000114928417904   0.000188636460539  -0.000342098336368  -0.000066175029416   0.000238503264360
                           0  -0.000372580156240  -0.000238170596598   0.000326401500550   0.000475368478319  -0.000316412075593  -0.000115610121677   0.000510037928690   0.000032654229517  -0.000055880190913   0.000036743110482   0.000121977520616
                           0   0.000381347158454   0.000418392004208   0.000363409188291   0.000312619594213   0.000478449514275   0.000374951001993   0.000289344092245   0.000503232930691   0.000311512487060   0.000368661851619   0.000496987546101
                           0  -0.000350642463792  -0.000256122007286   0.000221315549920   0.000479337884336  -0.000229239537669  -0.000375161003245   0.000494455331710   0.000285311840749  -0.000411414899475  -0.000000140125346   0.000373561133928
                           0  -0.001028556821341  -0.000550321004252   0.000427294477035   0.000267854237471  -0.000528060778699  -0.000146007206511   0.000238626258472   0.000058106813836  -0.000237703517401  -0.000267907761887   0.000235044745824
                           0   0.001470607613932   0.001104630153778   0.000693908376738   0.001047521455520   0.001075678144312   0.000716816836184   0.001067308354510   0.001000172545530   0.000813025241243   0.001039932898578   0.000925829643712
                           0  -0.001220561561037  -0.000556312022363   0.000640857759096   0.000390652535062  -0.000498357527665  -0.000044634413025   0.000354667804360   0.000186672899116  -0.000127066236867  -0.000282726582273   0.000424407521582
                           0  -0.001220561561037  -0.000556312022363   0.000640857759096   0.000390652535062  -0.000498357527665  -0.000044634413025   0.000354667804360   0.000186672899116  -0.000127066236867  -0.000282726582273   0.000424407521582
                           0   0.000411247366268   0.000783723253257   0.001185195258810   0.000889448066975   0.000827517944887   0.001098514917575   0.000830598417135   0.000976618464992   0.001102870583293   0.000660179224100   0.001113692773382
                           0  -0.001313123994174  -0.000540849077481   0.000548409991423   0.000032126342606  -0.000415929503275   0.000082352509071  -0.000011486718255   0.000109206313564  -0.000119538552282  -0.000268758850477   0.000211917106771
                           0  -0.002068207154932  -0.000822325766554   0.000747413570675   0.000021291751228  -0.000582173357075  -0.000067398598308   0.000066987305985   0.000140309115647  -0.000325829996985  -0.000327560438802   0.000223292785064
                           0  -0.000751405324894   0.000127623153835   0.000768958028860   0.000117510022535   0.000403827199982   0.000481224646423   0.000220219494910   0.000561159935628   0.000287394823985   0.000367101868953   0.000432392738362
                           0  -0.000130784766143  -0.000119361844084   0.000061531604887   0.000055594939369  -0.000149491263643  -0.000037307857267   0.000071106870346  -0.000081554393352  -0.000007101473751  -0.000051732094593  -0.000056033297982
                           0   0.000868292238354  -0.000134057795262  -0.000407673424867   0.000552840342167  -0.000656618391338  -0.000412036463656   0.000481977752137  -0.000631062696969   0.000012459782415  -0.000210976458533  -0.000303445476667
                           0   0.000299750569884   0.000102465430318  -0.000003970032811   0.000143659399951   0.000015112954188   0.000016024452364   0.000151054321642  -0.000017050370554   0.000093533776811   0.000092598651506   0.000006568799927
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0  -0.000054868036233  -0.000066803625883  -0.000037208405154  -0.000049497622331  -0.000073433187711  -0.000025990758984  -0.000081347772445  -0.000031048222364  -0.000030275634278  -0.000120175663698   0.000018520113828
                           0   0.000079849136284   0.000061965678277   0.000103237317673   0.000222758209568   0.000055827897662  -0.000044509741438   0.000276768193176   0.000102014286839  -0.000033508719295   0.000216507960909   0.000035887448641
                           0   0.000040754353682   0.000049592594230   0.000063860165488   0.000040500608490   0.000050186456048   0.000076162149398   0.000027008028344   0.000059097653062   0.000070837141305   0.000028990978474   0.000071076251111
                           0  -0.000262401763093  -0.000161260701196  -0.000116126689811  -0.000029962936393  -0.000017086867752  -0.000413775895795   0.000004492183063   0.000211974457441  -0.000574796066967  -0.000018279431991   0.000176563440338
                           0  -0.000249401333401  -0.000100764650622   0.000333235807903   0.000252200007878  -0.000197189260504   0.000216623370866   0.000234138020592  -0.000070126090885   0.000303543016837  -0.000012359799148  -0.000007872563493
                           0   0.000256659891586   0.000254954320431   0.000173835974802   0.000204392139157   0.000308478420443   0.000133882397796   0.000219070125223   0.000324583644071   0.000084966835626   0.000267501615941   0.000295392423994
                           0   0.000341385757748  -0.000144419303618  -0.000263921565105   0.000477400880282  -0.000243736596607  -0.000730737864105   0.000530576168640   0.000080427513851  -0.000684221383226   0.000141101917278   0.000070888004539
                           0  -0.000738969997830  -0.000297364447845   0.000422682316618   0.000083830064521  -0.000266711100004   0.000182670076971   0.000045923342879   0.000033475382230   0.000111120571304  -0.000180174883267   0.000141934557379
                           0   0.000848813189044   0.000491643111591   0.000197814736003   0.000529493177536   0.000424781254482   0.000187825946002   0.000513435499014   0.000439244124915   0.000216496360635   0.000486021578463   0.000421501049101
                           0  -0.002068207154932  -0.000822325766554   0.000747413570675   0.000021291751228  -0.000582173357075  -0.000067398598308   0.000066987305985   0.000140309115647  -0.000325829996985  -0.000327560438802   0.000223292785064
                           0  -0.001313123994174  -0.000540849077481   0.000548409991423   0.000032126342606  -0.000415929503275   0.000082352509071  -0.000011486718255   0.000109206313564  -0.000119538552282  -0.000268758850477   0.000211917106771
                           0  -0.000751405324894   0.000127623153835   0.000768958028860   0.000117510022535   0.000403827199982   0.000481224646423   0.000220219494910   0.000561159935628   0.000287394823985   0.000367101868953   0.000432392738362
                           0  -0.004278975953717  -0.001138464720055   0.001115922083755  -0.000796611779591  -0.000188288245334   0.000007313157165  -0.000279434027063   0.000290633392408  -0.000424240246000  -0.000205826381706   0.000026373180517
                           0  -0.004278975953717  -0.001138464720055   0.001115922083755  -0.000796611779591  -0.000188288245334   0.000007313157165  -0.000279434027063   0.000290633392408  -0.000424240246000  -0.000205826381706   0.000026373180517
                           0  -0.002230930038450  -0.000199184545904   0.000705778675102  -0.000340430190482   0.000410957076987   0.000244083668313   0.000079593730765   0.000383465344745   0.000110207038664   0.000246040419016   0.000189829783144
                           0   0.000575824808415  -0.000097877911578  -0.000078091154407   0.000291509846579  -0.000387505104307   0.000030660336787   0.000074409375716  -0.000190166643858   0.000097133323298  -0.000281128625249   0.000095035567704
                           0   0.000570054130729  -0.000217207183503  -0.000115676882831   0.000397269440038  -0.000601965521651  -0.000003808612181   0.000105971069271  -0.000294530901792   0.000089230628810  -0.000444682361390   0.000138499148366
                           0   0.000414996460451   0.000073159545098   0.000024547223838   0.000138582975060  -0.000034759136140   0.000080616386403   0.000070092042830   0.000017482522233   0.000095193965196  -0.000001552936552   0.000078808008142
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0  -0.000030166514956  -0.000042244839717  -0.000036971673932  -0.000018355870700  -0.000049191189033  -0.000036898358031  -0.000033168933805  -0.000019141893154  -0.000037852420274  -0.000067929936316   0.000024526505839
                           0  -0.000013780399381   0.000020406473362   0.000053697916314   0.000040550974709   0.000029858886687   0.000016035690981   0.000058845017891   0.000026305548513   0.000019850505304   0.000064861332603  -0.000015158778035
                           0   0.000019983930266   0.000021367708018   0.000017994820352   0.000019297286119   0.000023463848773   0.000018443905490   0.000018597877060   0.000025146161421   0.000017945634262   0.000017645203105   0.000028786195277
                           0  -0.000219380281899  -0.000161686582661  -0.000077270100173  -0.000044668737051  -0.000081753519336  -0.000271989585611  -0.000000106487071   0.000056677291682  -0.000422538340830   0.000041629477038  -0.000058645323627
                           0   0.000028104019986   0.000025328642238   0.000092018176910   0.000069820669765  -0.000023611519468   0.000128594917373   0.000034979686288  -0.000015057763503   0.000194197665157  -0.000052053368669   0.000074242594623
                           0   0.000071264744937   0.000054932467042   0.000047293191353   0.000058698411941   0.000060937727805   0.000032396748889   0.000061212464903   0.000072869455676   0.000004450030175   0.000077367871323   0.000052148475635
                           0  -0.000069179742384  -0.000168346247245  -0.000292225187431   0.000191220033882  -0.000164256240886  -0.000735936677584   0.000421375527534  -0.000219039511950  -0.000574692677583   0.000261804712189  -0.000517938363700
                           0  -0.000315913966900  -0.000087446565795   0.000186629894814  -0.000046961047464  -0.000039111326483   0.000147552669162  -0.000079234171403   0.000079831752614   0.000060456486103  -0.000074177854676   0.000119255801081
                           0   0.000019056861993   0.000066066323121   0.000061185641813   0.000078127051037   0.000089896602105  -0.000014831967734   0.000113041043606   0.000064104265337   0.000004594812905   0.000134165134093  -0.000007278223525
                           0   0.000868292238354  -0.000134057795262  -0.000407673424867   0.000552840342167  -0.000656618391338  -0.000412036463656   0.000481977752137  -0.000631062696969   0.000012459782415  -0.000210976458533  -0.000303445476667
                           0  -0.000130784766143  -0.000119361844084   0.000061531604887   0.000055594939369  -0.000149491263643  -0.000037307857267   0.000071106870346  -0.000081554393352  -0.000007101473751  -0.000051732094593  -0.000056033297982
                           0   0.000299750569884   0.000102465430318  -0.000003970032811   0.000143659399951   0.000015112954188   0.000016024452364   0.000151054321642  -0.000017050370554   0.000093533776811   0.000092598651506   0.000006568799927
                           0   0.000570054130729  -0.000217207183503  -0.000115676882831   0.000397269440038  -0.000601965521651  -0.000003808612181   0.000105971069271  -0.000294530901792   0.000089230628810  -0.000444682361390   0.000138499148366
                           0   0.000575824808415  -0.000097877911578  -0.000078091154407   0.000291509846579  -0.000387505104307   0.000030660336787   0.000074409375716  -0.000190166643858   0.000097133323298  -0.000281128625249   0.000095035567704
                           0   0.000414996460451   0.000073159545098   0.000024547223838   0.000138582975060  -0.000034759136140   0.000080616386403   0.000070092042830   0.000017482522233   0.000095193965196  -0.000001552936552   0.000078808008142
                           0  -0.000165055758358  -0.000136326760305   0.000066927802578   0.000167155483483  -0.000117160900873   0.000005286481230  -0.000020632275542  -0.000016216872445  -0.000012933373881  -0.000152722419324   0.000129759916709
                           0  -0.000165055758358  -0.000136326760305   0.000066927802578   0.000167155483483  -0.000117160900873   0.000005286481230  -0.000020632275542  -0.000016216872445  -0.000012933373881  -0.000152722419324   0.000129759916709
                           0  -0.000135682306145  -0.000011903983286   0.000057221938931  -0.000011301962841   0.000030592587308   0.000020262617725   0.000011982926296   0.000032222212483   0.000014070068431   0.000008015056025   0.000023878482340
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                           0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0];
                                       
% Define the expected solution in terms of the residual history
expSolResHistory = [   0.153336390222868   0.090085302664737   0.116672500339524   0.086640759810132   0.105777473554311   0.070164310239008   0.091255719136358   0.048104325828855   0.081252379610293   0.062418110207618   0.067834831569148
                       0.065581038647887   0.110330308620712   0.040388873932800   0.015834489429871   0.071141299196298   0.010291830282761   0.018239032543833   0.008711759275634   0.010782720564002   0.013108832163934   0.015329208891701
                       0.009731788828198   0.009217773248503   0.001491037285117   0.002438246176450   0.004688238590590   0.000101851056598   0.000179096215394   0.000145357815654   0.000053090355452   0.000123277427113   0.000224384216249
                       0.000684132158423   0.003443878028955   0.000034064020525   0.000009948254311   0.002796585736846   0.000000994620576   0.000000237973655   0.000000412845124   0.000000032387865   0.000000137918752   0.000007323071544
                       0.000007640910419   0.000048505953271   0.000000001027221   0.000000033006622   0.000029598646321   0.000000000001535   0.000000000000298   0.000000000002946   0.000000000000011   0.000000000000097   0.000000000056254
                       0.000000001223186   0.000000432470059   0.000000000000005   0.000000000000007   0.000000075756875                   0                   0                   0                   0                   0                   0
                       0.000000000000004   0.000000000000293                   0                   0   0.000000000000017                   0                   0                   0                   0                   0                   0];
                   
% Define the expected solution in terms of the minimum element area size
expSolMinElArea = 1.793548690011959e-04;

%% 9. Define the nonlinear analysis parameters

% number of load steps for the non-linear analysis
propNLinearAnalysis.method = 'newtonRapshon';

% number of load steps for the non-linear analysis
propNLinearAnalysis.noLoadSteps = 1;

% Assign a tolerance for the Newton iterations
propNLinearAnalysis.eps = 1e-9;

% Assign the maximum number of iterations
propNLinearAnalysis.maxIter = 7;

%% 10. Define transient analysis properties

% The Rayleigh parameters adjusted through experiments for this case
alphaR = 17.4670;
betaR = 1.8875e-04;

% Time dependence
propStrDynamics.timeDependence = 'transient';

% Time integration scheme
propStrDynamics.method = 'bossak'; % 'bossak', 'explicitEuler'
propStrDynamics.alphaB = 0; % -.1
propStrDynamics.betaB = .25; % .5
propStrDynamics.gammaB = .5; % .6
propStrDynamics.damping.method = 'rayleigh';
propStrDynamics.damping.computeDampMtx = @computeDampMtxRayleigh;
propStrDynamics.damping.alpha = alphaR;
propStrDynamics.damping.beta = betaR;

% Function handle to the computation of the matrices for the defined time
% integration scheme
if strcmp(propStrDynamics.method,'explicitEuler')
    propStrDynamics.computeProblemMtrcsTransient = ...
        @computeProblemMtrcsExplicitEuler;
elseif strcmp(propStrDynamics.method,'bossak')
    propStrDynamics.computeProblemMtrcsTransient = ...
        @computeProblemMtrcsBossak;
else
    error('Choose a time integration scheme');
end

% Function handle to the update of the discrete fields for the defined time
% integration scheme
if strcmp(propStrDynamics.method,'explicitEuler')
    propStrDynamics.computeUpdatedVct = ...
        @computeBETITransientUpdatedVctAccelerationField;
elseif strcmp(propStrDynamics.method,'bossak')
    propStrDynamics.computeUpdatedVct = ...
        @computeBossakTransientUpdatedVctAccelerationField;
else
    error('Choose a time integration scheme');
end

% Define function handle to the computation of the initial conditions
computeInitCnds = @computeNullInitCndsIGAThinStructure;

% Starting time of the simulation
TStart = 0;
propStrDynamics.TStart = TStart;

% End time of the simulation
TEnd = 0.1;
propStrDynamics.TEnd = TEnd;

% Number of time steps
timeStepScaling = 100;
propStrDynamics.noTimeSteps = timeStepScaling*(propStrDynamics.TEnd - propStrDynamics.TStart);

% Time step size
propStrDynamics.dt = (propStrDynamics.TEnd - propStrDynamics.TStart)/propStrDynamics.noTimeSteps;

%% 11. Solve the transient nonlinear problem
pathToOutput = 'undefined';
[dHatHistory,resHistory,~,~] = ...
    solve_IGAMembraneTransient...
    (BSplinePatches,computeInitCnds,propNLinearAnalysis,propStrDynamics,...
    propPostproc,solve_LinearSystem,propOutput,pathToOutput,caseName,...
    propEmpireCoSimulation,'');

%% 12. Verify the solution
testCase.verifyEqual(dHatHistory,expSolDispHistory,'AbsTol',absTol);
testCase.verifyEqual(resHistory,expSolResHistory,'AbsTol',absTol);
testCase.verifyEqual(BSplinePatch.minElArea,expSolMinElArea,'AbsTol',absTol);

end
